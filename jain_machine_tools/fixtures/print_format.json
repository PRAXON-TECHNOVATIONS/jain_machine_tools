[
 {
  "absolute_value": 0,
  "align_labels_right": 0,
  "css": "th { color: #111 !important; font-weight: 500 !important; }\n.print-format td, .print-format th { padding: 2px !important; }\n.tab_label { font-size: 11px !important; vertical-align: baseline !important; font-weight: bold; }\n.print-format th { border-bottom: 1px solid #111 !important; }\n.print-format td { vertical-align: baseline !important; }\n.item_tab thead th, .tax_tab thead th { font-weight: bold !important; text-align: center; vertical-align: middle !important; }\n.items-table { width: 100%; border-collapse: collapse; }\n.items-table thead { display: table-header-group; }\n.items-table tbody tr { page-break-inside: avoid; } \n.po-watermark { position: fixed; top: 30%; left: 0; width: 100%; text-align: center; font-size: 100px; font-weight: bold; color: rgba(200, 0, 0, 0.1); transform: rotate(-30deg); z-index: 9999; pointer-events: none; }\n\n/* MAIN LAYOUT CSS */\n.spring-container {\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    border: 2px solid #111 !important;\n    min-height: 280mm;\n    height: auto;\n    box-sizing: border-box;\n    margin-bottom: 2mm;\n    position: relative;\n    background-color: white;\n}\n\n.content-wrapper {\n    flex-grow: 1;\n    display: flex;\n    flex-direction: column;\n}\n\n.footer-wrapper {\n    flex-shrink: 0;\n    width: 100%;\n    margin-top: auto;\n    border-top: 1px solid #111;\n}\n\n@page {\n    size: A4;\n    margin: 4.5mm;\n    @bottom-center {\n        content: \"Page \" counter(page) \" of \" counter(pages);\n        font-size: 9px;\n        color: #555;\n        margin-bottom: 7mm;\n    }\n}\n\n.page-break {\n    page-break-after: always;\n}\n\n.header-above-container {\n    width: 100%;\n    height: 15px; \n    margin-bottom: 1px;\n    font-size: 12px;\n    font-weight: bold;\n    overflow: hidden; \n}\n.header-above-container .left { float: left; }\n.header-above-container .right { float: right; }",
  "custom_format": 1,
  "default_print_language": "en",
  "disabled": 0,
  "doc_type": "Quotation",
  "docstatus": 0,
  "doctype": "Print Format",
  "font": null,
  "font_size": 14,
  "format_data": null,
  "html": "<!-- ================= MACROS START ================= -->\n<!-- MODIFIED HEADER MACRO: Accepts 'show_quotation_details' parameter -->\n{% macro render_header(doc, show_quotation_details=True) %}\n    <table style=\"width: 100%; font-family: 'Helvetica Neue', Arial, sans-serif; border-bottom: 1px solid #111;\">\n        <tr>\n            <td style=\"width: 100%; vertical-align: top;\">\n                <img src=\"/files/JMT HEADER.png\" style=\"width: 100%; height: 130px;\">\n            </td>\n        </tr>\n    </table>\n    \n    <!-- CONDITIONALLY RENDER PO DETAILS BLUE BAR -->\n    {% if show_quotation_details %}\n    <div style=\"text-align:center;background-color:#b6e1fb;\">\n        <span style=\"font-weight: bold!important;\">\n            QUOTATION \n            {% if doc.workflow_state != \"Approved\" and doc.workflow_state != \"Rejected\"%} (NOT APPROVED) {% endif %}\n            {% if doc.workflow_state == \"Rejected\" %} (REJECTED) {% endif %}\n        </span>\n    </div>\n    {% endif %}\n\n    <table style=\"width:100%; border-collapse:collapse; font-family: Arial, sans-serif; font-size:10px;\">\n        <tr>\n            <td style=\"width:65%; vertical-align:top; border:1px solid #000;\">\n                <table style=\"width:100%; border-collapse:collapse;font-size:10px\">\n                    <tr><td><strong>Company Name:</strong> {{ doc.customer_name or \"\" }}</td></tr>\n                    <tr><td><strong>Kind Attention:</strong> {{ doc.contact_person or \"\" }}</td></tr>\n                    <tr>\n                        <td>\n                            <strong>Address:</strong><br/>\n                            {% if doc.address_display %}\n                                {{ doc.address_display or \"\" }}\n                            {% endif %}\n                        </td>\n                    </tr>\n                    <tr><td><strong>Contact No:</strong> {{ doc.contact_mobile or doc.contact_phone or \"\" }}</td></tr>\n                    <tr><td><strong>GST:</strong> {{ frappe.db.get_value(\"Address\", doc.customer_address, \"gstin\") or \"\" }} </td></tr>\n                </table>\n            </td>\n            \n            <td style=\"width:35%; vertical-align:top; border:1px solid #000;\">\n                <table style=\"width:100%;border-collapse:collapse; font-size:10px;\">\n                    <tr style=\"border-bottom:1px solid #000;\"><td style=\"border-right: 1px solid #000;\"><strong>Date</strong></td><td>{{ doc.transaction_date or \"\" }}</td></tr>\n                    <tr style=\"border-bottom:1px solid #000;\"><td style=\"border-right: 1px solid #000;\"><strong>Quote No</strong></td><td>{{ doc.name or \"\" }}</td></tr>\n                    <tr style=\"border-bottom:1px solid #000;\"><td style=\"border-right: 1px solid #000;\"><strong>Credit Period</strong></td><td>{{ doc.credit_days or \"\" }}</td></tr>\n                    <tr style=\"border-bottom:1px solid #000;\"><td style=\"border-right: 1px solid #000;\"><strong>Customer ID</strong></td><td>{{ doc.customer or \"\" }}</td></tr>\n                    <tr style=\"border-bottom:1px solid #000;\"><td style=\"border-right: 1px solid #000;\"><strong>Valid Until</strong></td><td>{{ doc.valid_till or \"\" }}</td></tr>\n                    <tr style=\"border-bottom:1px solid #000;\"><td style=\"border-right: 1px solid #000;\"><strong>Contact Person</strong></td><td>{{ doc.contact_display or \"\" }}</td></tr>\n                    <tr><td style=\"border-right: 1px solid #000;\"><strong>Contact No</strong></td><td>{{ doc.contact_mobile or doc.contact_phone or \"\" }}</td></tr>\n                </table>\n            </td>\n        </tr>\n    </table>\n    \n    <table style=\"width:100%; border-collapse:collapse;\">\n        <tr>\n            <td style=\"font-size:11px; padding-left:5px;\">\n                Dear Sir,<br>\n                Thank you for your enquiry :<br>\n                We are pleased to quote you the following\n            </td>\n        </tr>\n    </table>\n\n        \n    <!-- CONDITIONALLY RENDER 'QUOTATION DETAILS' HEADER ONLY IF REQUESTED -->\n    {% if show_quotation_details %}\n    <div style=\"text-align:center;background-color:#b6e1fb; border-top: 1px solid #000;\"><strong> QUOTATION DETAILS</strong></div>\n    {% endif %}\n{% endmacro %}\n\n{% macro render_terms_and_condition(doc) %}\n<table style =\"width:100%; border-collapse:collapse;\">\n    <tr style=\"border-bottom:1px solid #111; text-align:left;font-size:11px;\">\n        <td style=\"width:70%;\">\n            <table style=\"width:100%; border-collapse:collapse; font-size:10px;\">\n                <tr style=\"border-bottom:1px solid #000; background-color:#b6e1fb;\">\n                    <td><strong>TERMS & CONDITION</strong></td>\n                </tr>\n                <tr>\n                    <td style=\"vertical-align:top; white-space:pre-line; padding-bottom:6px;\"> {{ doc.custom_remarks or \"\" }} </td>\n                </tr>\n                {% if doc.terms %}\n                <tr><td style=\"border-top:0px solid #000; height:4px;\"></td></tr>\n                <tr>\n                    <td style=\"vertical-align:bottom; font-size:10px;\">\n                        {{ doc.terms }}\n                    </td>\n                </tr>\n                {% endif %}\n            </table>\n        </td>\n        <td style=\"width:30%;vertical-align:top; border:1px solid #000;\">\n            <table style=\"width:100%;border-collapse:collapse; font-size:10px;\">\n                {% set cgst_rate = doc.cgst_rate or (doc.items | map(attribute='cgst_rate') | max) or 0 %}\n                {% set sgst_rate = doc.sgst_rate or (doc.items | map(attribute='sgst_rate') | max) or 0 %}\n                {% set igst_rate = doc.igst_rate or (doc.items | map(attribute='igst_rate') | max) or 0 %}\n                {% set total_cgst = doc.cgst or doc.items | sum(attribute='cgst_amount') or 0 %}\n                {% set total_sgst = doc.sgst or doc.items | sum(attribute='sgst_amount') or 0 %}\n                {% set total_igst = doc.igst or doc.items | sum(attribute='igst_amount') or 0 %}\n                {% set is_igst = total_igst > 0 %}\n                \n                <tr style=\"border-bottom:1px solid #000;\">\n                    <td style=\"border-right: 1px solid #000;\"><strong>Subtotal</strong></td>\n                    <td>{{ frappe.format(doc.total,{\"fieldtype\":\"Currency\",\"options\":doc.currency}) or \"\" }}</td>\n                </tr>\n\n                {% if not is_igst %}\n                    <tr style=\"border-bottom:1px solid #000;\">\n                        <td style=\"border-right: 1px solid #000;\"><strong>CGST ({{ cgst_rate }}%)</strong></td>\n                        <td>{% if total_cgst > 0 %} {{ frappe.format(total_cgst, {\"fieldtype\": \"Currency\", \"options\": doc.currency}) }} {% endif %}</td>\n                    </tr>\n                    <tr style=\"border-bottom:1px solid #000;\">\n                        <td style=\"border-right: 1px solid #000;\"><strong>SGST ({{ sgst_rate }}%)</strong></td>\n                        <td>{% if total_sgst > 0 %} {{ frappe.format(total_sgst, {\"fieldtype\": \"Currency\", \"options\": doc.currency}) }} {% endif %}</td>\n                    </tr>\n                {% else %}\n                    <tr style=\"border-bottom:1px solid #000;\">\n                        <td style=\"border-right: 1px solid #000;\"><strong>IGST ({{ igst_rate }}%)</strong></td>\n                        <td>{% if total_igst > 0 %} {{ frappe.format(total_igst, {\"fieldtype\": \"Currency\", \"options\": doc.currency}) }} {% endif %}</td>\n                    </tr>\n                {% endif %}\n\n                <tr style=\"border-bottom:1px solid #000;\">\n                    {% set ns = namespace(disc_amt=0, disc_pct=0) %}\n                    {% for i in doc.items %}\n                        {% if i.discount_percentage and i.price_list_rate %}\n                            {% set ns.disc_amt = ns.disc_amt + ((i.price_list_rate * i.discount_percentage / 100) * i.qty) %}\n                            {% set ns.disc_pct = ns.disc_pct + i.discount_percentage %}\n                        {% endif %}\n                    {% endfor %}\n                    <td style=\"border-right: 1px solid #000;\"><strong> Discount {% if ns.disc_pct %} ({{ ns.disc_pct }}%) {% endif %} </strong></td>\n                    <td> {{ frappe.format( ns.disc_amt, {\"fieldtype\":\"Currency\",\"options\":doc.currency} ) }} </td>\n                </tr>\n                <tr style=\"border-bottom:1px solid #000;\">\n                    <td style=\"border-right: 1px solid #000;\"><strong>TCS</strong></td>\n                    <td> {{ frappe.format(doc.tcs_amount or 0, {\"fieldtype\":\"Currency\",\"options\":doc.currency}) }} </td>\n                </tr>\n                <tr style=\"border-bottom:1px solid #000;\">\n                    <td style=\"border-right: 1px solid #000;\"><strong>Round Off</strong></td>\n                    <td> {{ frappe.format(doc.rounding_adjustment or 0, {\"fieldtype\":\"Currency\",\"options\":doc.currency}) }} </td>\n                </tr>\n                <tr>\n                    <td style=\"border-right: 1px solid #000;\"><strong>Total Amt</strong></td>\n                    <td> {{ frappe.format(doc.rounded_total or 0, {\"fieldtype\":\"Currency\",\"options\":doc.currency}) }} </td>\n                </tr>\n            </table>\n        </td>\n    </tr>\n</table>\n\n<div style=\"padding-left:3px;font-size:10px;background-color:#b6e1fb; border-bottom: 1px solid #000;\">\n    <span style=\"font-weight:bold;\">Total Amount (In words):</span> {{ doc.in_words }}\n</div>\n\n{% set approved_user = frappe.db.get_value(\"Workflow Action\", {\"reference_name\": doc.name, \"completed_by_role\": \"Purchase Manager\", \"status\": \"Completed\"}, \"completed_by\", order_by=\"creation desc\") %}\n\n<table style=\"width: 100%; font-family: 'Helvetica Neue', Arial, sans-serif; border-bottom: 1px solid #111;\">\n    <tr>\n        <td style=\"width:70%; height:180px; position: relative;\">\n            <table style=\"width:100%; font-size:10px; position:absolute; bottom:5px; top:5px;\">\n                {% set company_dets = frappe.get_doc(\"Company\", doc.company) %}\n                <tr>\n                <td><b>GSTIN-{{ company_dets.gstin or \" \" }}</b></td><br>\n                </tr>\n                <tr>\n                <td><b>PAN No-{{ company_dets.pan or \" \" }}</b></td><br>\n                </tr>\n                <tr>\n                <td><b>BANK DETAILS-</b></td><br>\n                </tr>\n                {% set bank_dets = frappe.get_list(\"Bank Account\" , filters={\"company\": doc.company}, fields=\"name\") %}\n                {% set bank_detailed_record = frappe.get_doc(\"Bank Account\" , bank_dets[0].name) %}\n                <tr>\n                <td>BANK NAME:-{{ bank_detailed_record.bank }}</td><br>\n                </tr>\n                <tr>\n                <td>ACCOUNT NO:-{{ bank_detailed_record.bank_account_no }}</td><br>\n                </tr>\n                <tr>\n                <td>BANK BRANCH:-{{ bank_detailed_record.branch_code }}</td><br>\n                </tr>\n                <tr>\n                <td>RTGS/NEFT IFSC CODE:-{{ bank_detailed_record.custom_ifsc_code or \"BARB0MULUND\" }}</td><br>\n                </tr>\n                <tr>\n                <td>RTGS/NOTE:-Please treat the 5th article as number \"0\" in RTGS code</td><br>\n                </tr>\n                <td style=\"width:50%; text-align:left;\">\n                    <strong>Created By:</strong> {% if doc.owner %} {{ frappe.get_doc(\"User\", doc.owner).full_name or doc.owner }} {% endif %}\n                </td>\n                <td style=\"width:50%; text-align:left;\">\n                    <strong>Approved By:</strong> {% if approved_user %} {{ frappe.get_doc(\"User\", approved_user).full_name or approved_user }} {% else %} NA {% endif %}\n                </td>\n            </table>\n        </td>\n        <td style=\"width:30%; border-left: 1px solid #000; height:120px; font-size:10px; text-align:center;\">\n            <span><strong>For, JAIN MACHINE TOOLS & ELECTRICALS LLP</strong></span>\n            <p style=\"margin-top : 80px;\"><strong> AUTHORIZED SIGNATORY</strong></p>\n        </td>\n    </tr>\n</table>\n{% endmacro %}\n\n<!-- ================= FIXED LOGIC (Namespace based) ================= -->\n{# Use Namespace to prevent scope issues (Duplicates Fix) #}\n{% set ns = namespace(current_page=[], current_height=0, all_pages=[]) %}\n\n{# Settings #}\n{% set max_lines = 32 %}\n{# Padding = 2 ensures Last Item travels with Total Row if space is tight #}\n{% set total_row_padding = 1 %} \n\n{% for item in doc.items %}\n    {# 1. Calculate how many visual lines this item takes #}\n    {% set newlines = ((item.description or \"\")|string).count('\\n') %}\n    {% set wraps = (((item.description or \"\")|length) / 50) | int %}\n    {% set lines = 1 + newlines + wraps %}\n    \n    {# 2. Check if this is the VERY LAST item #}\n    {% set effective_lines = lines %}\n    {% if loop.last %}\n        {# If last item, pretend it is taller to check if Total Row fits #}\n        {% set effective_lines = lines + total_row_padding %}\n    {% endif %}\n\n    {# 3. Overflow Check #}\n    {% if (ns.current_height + effective_lines) > max_lines %}\n        {# Page Full: Save current page, Start new page with this item #}\n        {% set _ = ns.all_pages.append(ns.current_page) %}\n        {% set ns.current_page = [item] %}\n        {% set ns.current_height = lines %} \n    {% else %}\n        {# Page Fits: Add item #}\n        {% set _ = ns.current_page.append(item) %}\n        {% set ns.current_height = ns.current_height + lines %}\n    {% endif %}\n\n{% endfor %}\n\n{# 4. Add the final leftover page #}\n{% if ns.current_page %}\n    {% set _ = ns.all_pages.append(ns.current_page) %}\n{% endif %}\n\n{# 5. Determine if Remarks need to move to a separate page #}\n{# Check the height of the LAST page generated #}\n{% set last_page_items = ns.all_pages[-1] %}\n{% set ns_last = namespace(h=0) %}\n{% for i in last_page_items %}\n    {% set nl = ((i.description or \"\")|string).count('\\n') %}\n    {% set wr = (((i.description or \"\")|length) / 50) | int %}\n    {% set ns_last.h = ns_last.h + 1 + nl + wr %}\n{% endfor %}\n{# If last page + total row > 14 (approx half page), move remarks #}\n{% set move_terms_and_condition = (ns_last.h + total_row_padding) > 14 %}\n\n\n<!-- ================= RENDERING ================= -->\n\n{% if doc.workflow_state == \"Rejected\" or doc.workflow_state != \"Approved\" %}\n<div class=\"po-watermark\">\n    {% if doc.workflow_state != \"Approved\" and doc.workflow_state != \"Rejected\" %} NOT APPROVED \n    {% elif doc.workflow_state == \"Rejected\" %} REJECTED {% endif %}\n</div>\n{% endif %}\n\n{% set sr_no = namespace(val=0) %}\n\n{% for batch in ns.all_pages %}\n    {% set is_last_page = loop.last %}\n    \n    <div class=\"header-above-container\">\n        <div class=\"left\"> {{ doc.name }} </div>\n        <div class=\"right\"> {{ frappe.utils.formatdate(doc.transaction_date, \"dd-MMM-yyyy\") }} </div>\n    </div> \n\n    <div class=\"spring-container {% if not is_last_page or move_terms_and_condition %}page-break{% endif %}\">\n        \n        <div class=\"content-wrapper\">\n            <!-- Normal pages get PO DETAILS blue bar -->\n            {{ render_header(doc, show_quotation_details=True) }}\n\n            <table class=\"items-table\" style=\"width:100%; border-bottom:1px solid #000;border-top:1px solid #000;\">\n                <thead>\n                    <tr style=\"font-weight:bold; font-size:11px;\">\n                        <th width=\"5%\" style=\"border-right:1px solid #000;\"><strong>Sr. No.</strong></th>\n                        <th width=\"55%\" style=\"border-right:1px solid #000; text-align:center;\"><strong>Description</strong></th>\n                        <!--<th width=\"10%\" style=\"border-right:1px solid #000;\"><strong>List Price</strong></th>-->\n                        <!--<th width=\"10%\" style=\"border-right:1px solid #000;\"><strong>Discount Percent</strong></th>-->\n                        <th width=\"10%\" style=\"border-right:1px solid #000;\"><strong>Unit Rate</strong></th>\n                        <th width=\"10%\" style=\"border-right:1px solid #000;\"><strong>Qty</strong></th>\n                        <th width=\"10%\" style=\"border-right:1px solid #000;\"><strong>UOM</strong></th>\n                        <th width=\"10%\"><strong>Net Amount</strong></th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {% for row in batch %}\n                    {% set sr_no.val = sr_no.val + 1 %}\n                    <tr style=\"font-size:10px; border-bottom:1px solid #000;\">\n                        <td style=\"text-align:center; border-right:1px solid #000;\">{{ sr_no.val }}</td>\n                        <td style=\"text-align:center;border-right:1px solid #000; white-space: pre-wrap;\">{{ row.description }}</td>\n                        <td style=\"text-align:center;border-right:1px solid #000; white-space: nowrap;\">{{ row.rate }}</td>\n                        <td style=\"text-align:center;border-right:1px solid #000;\">{{ row.qty }}</td>\n                        <td style=\"text-align:center;border-right:1px solid #000;\">{{ row.uom }}</td>\n                        <td style=\"text-align:center; white-space: nowrap;\">{{ row.amount }}</td>\n                    </tr>\n                    {% endfor %}\n\n                    {# Total Row Logic #}\n                    {% if is_last_page %}\n                    <tr style=\"font-weight:bold; font-size:11px; background-color:#b6e1fb;\">\n                        <td colspan=\"2\" style=\"border:1px solid #111; text-align:left; padding-left:5px;\"> Total </td>\n                        <td style=\"border:1px solid #111;\"></td>\n                        <td style=\"border:1px solid #111; text-align:center;\"> {{ doc.items | sum(attribute='qty') }} </td>\n                        <td style=\"border:1px solid #111;\"></td>\n                        <td style=\"border:1px solid #111; text-align:center; vertical-align: middle;\">\n                            <div style=\"line-height: 1; white-space: nowrap;\">\n                                <span style=\"font-weight: bold; font-size: 10px;\">{{ frappe.format(doc.items | sum(attribute='net_amount'), {\"fieldtype\":\"Currency\", \"options\": doc.currency}) }}</span>\n                            </div>\n                        </td>\n                    </tr>\n                    {% endif %}\n                </tbody>\n            </table>\n\n            {% if is_last_page and not move_terms_and_condition %}\n                {{ render_terms_and_condition(doc) }}\n            {% endif %}\n        </div>\n\n        <div class=\"footer-wrapper\">\n            <img src=\"/files/JMT FOOTER.png\" style=\"width: 100%; height: 60px; display: block;\">\n        </div>\n    </div> \n    \n    {# Separate Remarks Page if needed #}\n    {% if is_last_page and move_terms_and_condition %}\n    <div class=\"header-above-container\">\n        <div class=\"left\"> {{ doc.name }} </div>\n        <div class=\"right\"> {{ frappe.utils.formatdate(doc.transaction_date, \"dd-MMM-yyyy\") }} </div>\n    </div> \n    <div class=\"spring-container\">\n        <div class=\"content-wrapper\">\n            <!-- Remarks only page gets NO blue bar -->\n            {{ render_header(doc, show_quotation_details=False) }}\n            <div style=\"margin-top: 0px;\">\n                {{ render_terms_and_condition(doc) }}\n            </div>\n        </div>\n        <div class=\"footer-wrapper\">\n            <img src=\"/files/JMT FOOTER.png\" style=\"width: 100%; height: 60px; display: block;\">\n        </div>\n    </div>\n    {% endif %}\n\n{% endfor %}",
  "line_breaks": 0,
  "margin_bottom": 15.0,
  "margin_left": 15.0,
  "margin_right": 15.0,
  "margin_top": 15.0,
  "modified": "2026-02-20 09:55:07.952664",
  "module": "Jain Machine Tools",
  "name": "Custom Quotation Print Format",
  "page_number": "Hide",
  "pdf_generator": "wkhtmltopdf",
  "print_format_builder": 0,
  "print_format_builder_beta": 0,
  "print_format_for": "DocType",
  "print_format_type": "Jinja",
  "raw_commands": null,
  "raw_printing": 0,
  "report": null,
  "show_section_headings": 0,
  "standard": "No"
 }
]